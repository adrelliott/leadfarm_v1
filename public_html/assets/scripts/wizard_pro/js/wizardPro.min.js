/*
 * jQuery WizardPro Plugin v1.1
 * Copyright (c) 2010 Philo Hermans
 * http://www.philohermans.com
 * http://codecanyon.net/user/Philo01
 */
 
(function(a){a.fn.wizardPro=function(f){if(this.length>1){this.each(function(){a(this).wizardPro(f)});return this}var t=a(this),n=a(this).find("ul.steps"),l=a(this).find("ul.steps li");var j={fadeInWizard:500,autoSpaceSteps:true,stepArrows:true,defaultAjaxRequest:true,useValidation:true,formClass:".defaultRequest",enableHelpers:true,helperArrows:true,userHoverIntent:true,interactionBlock:true,fadeInBlock:500};var f=a.extend(j,f);this.intialize=function(){return this};var e=function(){var u=a(t).find(".step_content").height();a(t).find(".helper").css("height",u).animate({width:"hide"},500);if(f.interactionBlock&&a.browser.msie&&a.browser.version.substr(0,1)<7){a(t).find(".step_content .blockuser").css("height",u+"px")}};a(this).find(".no_javascript").hide();a(this).removeClass("js");if(f.fadeInWizard>0){a(this).hide();a(this).fadeIn(f.fadeInWizard)}if(f.interactionBlock){a(t).find(".step_content").prepend('<div class="blockuser"><span></span></div>')}if(f.enableHelpers){if(f.helperArrows){a(this).find(".helper").prepend('<span class="arrow"></span>')}if(jQuery().hoverIntent&&f.userHoverIntent){a(this).find("a.show_helper").hoverIntent({over:o,timeout:1000,out:b,interval:150})}else{a(this).find("a.show_helper").mouseover(function(){q(a(this))}).mouseout(function(){p(a(this))})}}function o(){var u=a(this).position();a(a(this).attr("href")).animate({width:"show"},500,function(){a("span.arrow").css("margin-top","0").hide();a("span.arrow").animate({marginTop:(u.top-7),opacity:"show"},{queue:true,duration:800})})}function q(v){var u=a(v).position();a(a(v).attr("href")).animate({width:"show"},500,function(){a("span.arrow").css("margin-top","0").hide();a("span.arrow").animate({marginTop:(u.top-7),opacity:"show"},{queue:true,duration:800})})}function b(){a(a(this).attr("href")).animate({width:"hide"},500)}function p(u){a(a(u).attr("href")).animate({width:"hide"},500)}if(f.autoSpaceSteps){var r=a(n).width();var h=0;var m=a(l).size();var i=1;a(n).find("li:first-child").addClass("current");a(l).each(function(u){h=h+a(this).width();a(this).contents().wrap("<p></p>");if(f.stepArrows){if(m!=(u+1)){a(this).append("<span></span>")}}});var s=r-h;var g=Math.floor(s/m/2);a(l).each(function(){a(this).css({"padding-right":g,"padding-left":g})})}var c=a(this).find(".step_content div.step:first").addClass("current");a(this).find(".step_content div.step:first ~ div.step").hide();e();a(this).find(".next").click(function(){k("next")});a(this).find(".prev").click(function(){k("prev")});if(f.useValidation){a(this).find(f.formClass).validate()}if(f.defaultAjaxRequest){a(this).find(f.formClass).submit(function(){var u=a(this).attr("action");var w=a(this);if(f.useValidation){var v=a(w).valid()}else{v=true}if(v){a(document).ajaxStart(function(){if(f.interactionBlock){d(1)}}).ajaxStop(function(){if(f.interactionBlock){d(0)}e()});a.ajax({type:"POST",url:u,data:a(this).serialize(),dataType:"json",success:function(x){if(x.response){a("div.errormsg").remove();if(x.step){k(x.step)}else{k("next")}}else{a("div.errormsg").remove();a('<div class="errormsg">'+x.message+"</div>").insertBefore(w)}}})}e();return false})}var d=this.interactionBlock=function(u){if(u==1){a(t).find(".step_content .blockuser").fadeIn(f.fadeInBlock)}else{if(u==0){a(t).find(".step_content .blockuser").fadeOut(f.fadeInBlock)}}};var k=this.openstep=function(w){var v=a(t).find(".step_content div.step.current");var u=a(t).find(".step_content div.step").size();a(v).fadeOut(function(){a(v).removeClass("current");a(n).find("li").removeClass("completed");if(w=="next"){a(this).next(".step").fadeIn().addClass("current");a(n).find("li.current").removeClass("current").addClass("completed").next("li").addClass("current")}else{if(w=="prev"){a(this).prev(".step").fadeIn().addClass("current");a(n).find("li.current").removeClass("current").prev("li").addClass("current").prev("li").addClass("completed")}else{a(v).parent().find("div.step:nth-child("+(w+1)+")").fadeIn().addClass("current");a(n).find("li.current").removeClass("current");a(n).find("li:nth-child("+w+")").addClass("current");a(n).find("li.current").prev("li").addClass("completed")}}if(a(n).find("li:last-child").hasClass("current")){var x=a(n).find("li.current").css("background-color");a(n).css("background-color",x)}else{var x=a(n).find("li").css("background-color");a(n).css("background-color",x)}e()})};return this.intialize()}})(jQuery);